{
    "lists": {
        "name": "tds",
        "desc": "Input metadata for tests",
        "data": {
            "trackers": {
                "bad.third-party.site": {
                    "owner": {
                        "name": "Test Site for Tracker Blocking",
                        "displayName": "Bad Third Party Site",
                        "privacyPolicy": "",
                        "url": "http://bad.third-party.site"
                    },
                    "prevalence": 0.1,
                    "fingerprinting": 3,
                    "cookies": 0.1,
                    "categories": [],
                    "default": "block",
                    "rules": [
                        {
                            "rule": "bad\\.third-party\\.site\\/ignore",
                            "action": "ignore"
                        },
                        {
                            "rule": "bad\\.third-party\\.site",
                            "exceptions": {
                                "domains": [
                                    "ignore.test"
                                ],
                                "types": [
                                    "image"
                                ]
                            }
                        }
                    ]
                },
                "broken.third-party.site": {
                    "owner": {
                        "name": "Test Site for Tracker Blocking",
                        "displayName": "Broken Third Party Site",
                        "privacyPolicy": "",
                        "url": "http://broken.third-party.site"
                    },
                    "prevalence": 0.1,
                    "fingerprinting": 3,
                    "cookies": 0.1,
                    "categories": [],
                    "rules": [],
                    "default": "ignore"
                },
                "tracker.test": {
                    "owner": {
                        "name": "Test Site for Tracker Blocking",
                        "displayName": "Bad Third Party Site",
                        "privacyPolicy": "",
                        "url": "http://tracker.test"
                    },
                    "prevalence": 0.1,
                    "fingerprinting": 3,
                    "cookies": 0.1,
                    "categories": [],
                    "default": "block"
                },
                "ignore.test": {
                    "owner": {
                        "name": "Test Site for Tracker Blocking",
                        "displayName": "ignore Site",
                        "privacyPolicy": "",
                        "url": "http://ignore.test"
                    },
                    "prevalence": 0.1,
                    "fingerprinting": 3,
                    "cookies": 0.1,
                    "categories": [],
                    "default": "ignore",
                    "rules": [
                        {
                            "rule": "ignore\\.test\\/tracker",
                            "action": "block"
                        }
                    ]
                }
            },
            "entities" : {
                "Test Site for Tracker Blocking": {
                    "domains": [
                        "bad.third-party.site",
                        "broken.third-party.site",
                        "third-party.site",
                        "tracker.test"
                    ],
                    "prevalence": 0.1,
                    "displayName": "Test Site for Tracker Blocking"
                },
                "ignore Site for Tracker Blocking": {
                    "domains": [
                        "ignore.test",
                        "sub.ignore.test"
                    ],
                    "prevalence": 0.1,
                    "displayName": "ignore Site for Tracker Blocking"
                }
            },
            "cnames": {}
        }
    },
    "tests": {
        "domainTests": {
            "name": "URL-matching",
            "desc": "interactions between root domain and resource URLs from tracker lists",
            "tests": [
                {
                    "name": "same party tracker",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "script",
                    "expect_action": "ignore",
                    "except_platforms": []
                },
                {
                    "name": "bad loads same root domain resources",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://third-party.site/",
                    "request_type": "script",
                    "expect_action": null,
                    "except_platforms": []
                },
                {
                    "name": "same party ignore",
                    "site_url": "https://ignore.test/",
                    "request_url": "https://ignore.test/",
                    "request_type": "script",
                    "expect_action": "ignore"
                },
                {
                    "name": "tracker loads ignore",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://ignore.test/",
                    "request_type": "script",
                    "expect_action": "ignore"
                },
                {
                    "name": "ignore loads tracker",
                    "site_url": "https://ignore.test/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "image",
                    "expect_action": "ignore"
                },
                {
                    "name": "notignore doesn't load tracker",
                    "site_url": "https://notignore.test/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "script",
                    "expect_action": "block"
                },
                {
                    "name": "notignore blocks tracker",
                    "site_url": "https://randomsite123.com/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "script",
                    "expect_action": "block"
                },
                {
                    "name": "sub.ignore loads tracker",
                    "site_url": "https://sub.ignore.test/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "image",
                    "expect_action": "ignore"
                },
                {
                    "name": "tracker loads ignore resource type",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://ignore.test/",
                    "request_type": "image",
                    "expect_action": "ignore"
                },
                {
                    "name": "tracker blocks non-ignore resource type",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://ignore.test/",
                    "request_type": "script",
                    "expect_action": "ignore"
                },
                {
                    "name": "tracker loads random",
                    "site_url": "https://bad.third-party.site/",
                    "request_url": "https://random.test/",
                    "request_type": "script",
                    "expect_action": null
                },
                {
                    "name": "random does not load tracker",
                    "site_url": "https://random.test/",
                    "request_url": "https://bad.third-party.site/",
                    "request_type": "script",
                    "expect_action": "block"
                },
                {
                    "name": "random loads itself",
                    "site_url": "https://random.test/",
                    "request_url": "https://random.test/",
                    "request_type": "script",
                    "expect_action": null
                },
                {
                    "name": "random loads ignore path on tracker",
                    "site_url": "https://random.test/",
                    "request_url": "https://bad.third-party.site/ignore",
                    "request_type": "script",
                    "expect_action": "ignore"
                },
                {
                    "name": "random loads broken.tracker",
                    "site_url": "https://random.test/",
                    "request_url": "https://broken.third-party.site/",
                    "request_type": "script",
                    "expect_action": "ignore"
                },
                {
                    "name": "random loads randomsub.tracker",
                    "site_url": "https://random.test/",
                    "request_url": "https://randomsub.third-party.site/",
                    "request_type": "script",
                    "expect_action": null
                },
                {
                    "name": "random loads randomsub.tracker",
                    "site_url": "https://random.test/",
                    "request_url": "https://randomsub.third-party.site/",
                    "request_type": "script",
                    "expect_action": null
                },
                {
                    "name": "tracker loads permitted for same entity",
                    "site_url": "https://third-party.site/",
                    "request_url": "https://tracker.test/",
                    "request_type": "script",
                    "expect_action": "ignore"
                },      
                {
                    "name": "block tracker path in ignore domain",
                    "site_url": "https://random.test/",
                    "request_url": "https://ignore.test/tracker?abc=2",
                    "request_type": "script",
                    "expect_action": "block"
                }
            ]
        },
        "safeTests": {
            "name": "safe-matching",
            "desc": "tests for safelist interactions",
            "tests": []
        }
    }
}